# DFTåŠæ•°å­—æ»¤æ³¢å™¨

Owner: æŸ’æŸ’åœ¨ç¬”è®°
è¯¾ç¨‹: Matlab

## **ä¸€ã€å®éªŒåç§°**

### Matlabåœ¨æ•°å­—ä¿¡å·å¤„ç†ä¸­çš„åº”ç”¨ â€”â€”DFTåŠæ•°å­—æ»¤æ³¢å™¨

## **äºŒã€å®éªŒå†…å®¹**

1. **è®¡ç®—åºåˆ—çš„DFT**
2. **è®¡ç®—åœ†å‘¨å·ç§¯ä¸çº¿æ€§å·ç§¯**
3. **æ•°å­—æ»¤æ³¢å™¨è®¾è®¡**

## **ä¸‰ã€å®éªŒæ­¥éª¤**

1. **è®¡ç®—åºåˆ—çš„DFT**
    1. ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º10çš„å…¨1å‘é‡R10nã€‚
    2. å¯¹R10nè¿›è¡Œ20ï¼Œ40ï¼Œå’Œ80ç‚¹çš„ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œå¹¶åˆ†åˆ«å‘½åä¸ºDFT20ï¼ŒDFT40ï¼Œå’ŒDFT80ã€‚
    3. åœ¨å…­ä¸ªå­å›¾ä¸­åˆ†åˆ«ç»˜åˆ¶20ã€40ã€80ç‚¹DFTçš„å¹…åº¦å’Œç›¸ä½ã€‚
2. **è®¡ç®—åœ†å‘¨å·ç§¯ä¸çº¿æ€§å·ç§¯**
    1. å®šä¹‰ä¸¤ä¸ªå‘é‡x1å’Œx2ï¼Œä»–ä»¬åˆ†åˆ«ä»£è¡¨äº†ä¸¤ä¸ªä¸åŒçš„ç¦»æ•£ä¿¡å·ã€‚
    2. é€šè¿‡MATLABæä¾›çš„`fft`å‡½æ•°è®¡ç®—x1å’Œx2çš„ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œä¿å­˜è‡³X1å’ŒX2ä¸­ã€‚
    3. åˆ©ç”¨X1å’ŒX2è®¡ç®—å‡ºåœ†å‘¨å·ç§¯ï¼Œæ–¹æ³•æ˜¯å°†ä¸¤è€…ç›¸ä¹˜åå†ä½¿ç”¨`ifft`å‡½æ•°è¿›è¡Œé€†å‚…ç«‹å¶å˜æ¢ã€‚
    4. ä½¿ç”¨subplotå‡½æ•°å½¢æˆä¸¤ä¸ªå­å›¾ï¼Œç¬¬ä¸€ä¸ªå­å›¾ç”¨äºç»˜åˆ¶åœ†å‘¨å·ç§¯çš„ç»“æœï¼Œç¬¬äºŒä¸ªå­å›¾ç”¨äºç»˜åˆ¶çº¿æ€§å·ç§¯çš„ç»“æœã€‚
    5. ç”±äºåœ†å‘¨å·ç§¯ä¸çº¿æ€§å·ç§¯ç»“æœçš„é•¿åº¦ä¸åŒï¼Œå› æ­¤åœ¨è¿›è¡Œå‚…ç«‹å¶é€†å˜æ¢å‰ï¼Œéœ€è¦å¯¹x1å’Œx2åšé›¶å¡«å……å¤„ç†ï¼Œä»¥ä½¿å¾—å®ƒä»¬çš„é•¿åº¦æ»¡è¶³çº¿æ€§å·ç§¯çš„è¦æ±‚ã€‚
    6. è®¡ç®—é›¶å¡«å……åçš„x1å’Œx2çš„ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œå¹¶å†æ¬¡è¿›è¡Œåœ†å‘¨å·ç§¯å¤„ç†å¾—åˆ°çº¿æ€§å·ç§¯çš„ç»“æœã€‚
    7. åœ¨ç¬¬äºŒä¸ªå­å›¾ä¸­å±•ç¤ºä½¿ç”¨å‚…ç«‹å¶è½¬æ¢å¾—åˆ°çš„çº¿æ€§å·ç§¯ç»“æœã€‚
3. **æ•°å­—æ»¤æ³¢å™¨è®¾è®¡**
    1. å®šä¹‰äº†æ»¤æ³¢å™¨è®¾è®¡çš„è‹¥å¹²æŠ€æœ¯å‚æ•°ï¼ŒåŒ…æ‹¬é€šå¸¦å’Œé˜»å¸¦çš„è¾¹ç•Œé¢‘ç‡ï¼ˆws1ã€wp1ã€ws2ã€wp2ï¼‰ï¼Œé€šå¸¦çº¹æ³¢(passband_ripple)ï¼Œä»¥åŠé˜»å¸¦è¡°å‡(stopband_attenuation)ã€‚
    2. æ ¹æ®é€šå¸¦å’Œé˜»å¸¦çš„è¾¹ç•Œé¢‘ç‡è®¡ç®—å‡ºé˜»å¸¦å®½åº¦(wn)ï¼Œå¹¶æ®æ­¤è®¡ç®—å‡ºæ»¤æ³¢å™¨çš„é˜¶æ•°ã€‚
    3. ä½¿ç”¨MATLABæä¾›çš„fir1å‡½æ•°å’Œhanningçª—å‡½æ•°è®¾è®¡å¸¦é€šæ»¤æ³¢å™¨ï¼Œå¾—åˆ°æ»¤æ³¢å™¨çš„ç³»æ•°hnã€‚
    4. ä½¿ç”¨freqzå‡½æ•°è®¡ç®—æ»¤æ³¢å™¨çš„é¢‘ç‡å“åº”Hï¼Œç„¶ååœ¨å­å›¾1ä¸­ç»˜åˆ¶æ»¤æ³¢å™¨çš„å¹…åº¦é¢‘ç‡å“åº”ã€‚å¹…åº¦ä»¥dBä¸ºå•ä½ï¼Œå¹¶ä½¿ç”¨çº¢è‰²è™šçº¿æŒ‡ç¤ºé€šå¸¦çº¹æ³¢å’Œé˜»å¸¦è¡°å‡çš„é™åˆ¶ã€‚
    5. åœ¨å­å›¾2ä¸­ï¼Œç»˜åˆ¶æ»¤æ³¢å™¨çš„ç›¸ä½é¢‘ç‡å“åº”ï¼Œä»¥å¼§åº¦ä¸ºå•ä½

## **å››ã€å®éªŒç»“æœ**

1. **è®¡ç®—åºåˆ—çš„DFT**
    
    ![Untitled](Untitled%2018.png)
    
2. **è®¡ç®—åœ†å‘¨å·ç§¯ä¸çº¿æ€§å·ç§¯**
    
    ![Untitled](Untitled%2019.png)
    
3. **æ•°å­—æ»¤æ³¢å™¨è®¾è®¡**
    
    ![Untitled](Untitled%2020.png)
    
    ![Untitled](Untitled%2021.png)
    

## **äº”ã€é™„å½•**

1. **è®¡ç®—åºåˆ—çš„DFT**
    
    ```matlab
    % å®šä¹‰ğ‘…_10 (ğ‘›)
    R10n = ones(1, 10);
    
    % è®¡ç®—20ç‚¹DFT
    DFT20 = fft(R10n, 20);
    
    % è®¡ç®—40ç‚¹DFT
    DFT40 = fft(R10n, 40);
    
    % è®¡ç®—80ç‚¹DFT
    DFT80 = fft(R10n, 80);
    
    % ç»˜åˆ¶20ç‚¹DFTçš„å¹…åº¦
    subplot(3, 2, 1);
    stem(0:19, abs(DFT20));
    title('20ç‚¹DFT å¹…åº¦');
    xlabel('é¢‘ç‡');
    ylabel('å¹…åº¦');
    
    % ç»˜åˆ¶20ç‚¹DFTçš„ç›¸ä½
    subplot(3, 2, 2);
    stem(0:19, angle(DFT20));
    title('20ç‚¹DFT ç›¸ä½');
    xlabel('é¢‘ç‡');
    ylabel('ç›¸ä½');
    
    % ç»˜åˆ¶40ç‚¹DFTçš„å¹…åº¦
    subplot(3, 2, 3);
    stem(0:39, abs(DFT40));
    title('40ç‚¹DFT å¹…åº¦');
    xlabel('é¢‘ç‡');
    ylabel('å¹…åº¦');
    
    % ç»˜åˆ¶40ç‚¹DFTçš„ç›¸ä½
    subplot(3, 2, 4);
    stem(0:39, angle(DFT40));
    title('40ç‚¹DFT ç›¸ä½');
    xlabel('é¢‘ç‡');
    ylabel('ç›¸ä½');
    
    % ç»˜åˆ¶80ç‚¹DFTçš„å¹…åº¦
    subplot(3, 2, 5);
    stem(0:79, abs(DFT80));
    title('80ç‚¹DFT å¹…åº¦');
    xlabel('é¢‘ç‡');
    ylabel('å¹…åº¦');
    
    % ç»˜åˆ¶80ç‚¹DFTçš„ç›¸ä½
    subplot(3, 2, 6);
    stem(0:79, angle(DFT80));
    title('80ç‚¹DFT ç›¸ä½');
    xlabel('é¢‘ç‡');
    ylabel('ç›¸ä½');
    ```
    
2. **è®¡ç®—åœ†å‘¨å·ç§¯ä¸çº¿æ€§å·ç§¯**
    
    ```matlab
    % å®šä¹‰ğ‘¥1(ğ‘›)å’Œğ‘¥2(ğ‘›)
    x1 = [0, 1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1];
    x2 = [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0];
    
    % è®¡ç®—ğ‘¥1(ğ‘›)å’Œğ‘¥2(ğ‘›)çš„DFT
    X1 = fft(x1);
    X2 = fft(x2);
    
    % è®¡ç®—åœ†å‘¨å·ç§¯
    circular_conv = ifft(X1 .* X2);
    
    % è®¡ç®—çº¿æ€§å·ç§¯
    linear_conv = conv(x1, x2);
    
    % ç»˜åˆ¶åœ†å‘¨å·ç§¯
    subplot(2, 1, 1);
    stem(0:length(circular_conv)-1, circular_conv);
    title('åœ†å‘¨å·ç§¯');
    xlabel('n');
    ylabel('y[n]');
    
    % è¡¥é›¶
    N = length(x1) + length(x2) - 1;
    x1_padded = [x1, zeros(1, N-length(x1))];
    x2_padded = [x2, zeros(1, N-length(x2))];
    
    % è®¡ç®—x1(n)å’Œx2(n)çš„DFT
    X1 = fft(x1_padded);
    X2 = fft(x2_padded);
    
    % è®¡ç®—çº¿æ€§å·ç§¯
    linear_conv_fft = ifft(X1 .* X2);
    
    % ç»˜åˆ¶çº¿æ€§å·ç§¯
    subplot(2, 1, 2);
    stem(0:length(linear_conv_fft)-1, linear_conv_fft);
    title('ä½¿ç”¨FFTè®¡ç®—çš„çº¿æ€§å·ç§¯');
    xlabel('n');
    ylabel('y[n]');
    ```
    
3. **æ•°å­—æ»¤æ³¢å™¨è®¾è®¡**
    
    ```matlab
    % å®šä¹‰æŠ€æœ¯æŒ‡æ ‡
    ws1 = 0.3;
    wp1 = 0.4;
    ws2 = 0.7;
    wp2 = 0.6;
    passband_ripple = 0.5; % dB
    stopband_attenuation = 40; % dB
    
    % è®¡ç®—æ»¤æ³¢å™¨çš„é˜¶æ•°
    wn = wp1 - ws1;
    N = ceil(6.2 / wn);
    
    % ä½¿ç”¨æ±‰å®çª—è®¾è®¡å¸¦é€šæ»¤æ³¢å™¨
    wc = [(ws1 + wp1) / 2, (ws2 + wp2) / 2];
    hn = fir1(N-1, wc, hanning(N));
    
    % è®¡ç®—å¹¶ç»˜åˆ¶æ»¤æ³¢å™¨çš„é¢‘ç‡å“åº”
    [H, W] = freqz(hn, 1, 'half');
    subplot(2, 1, 1);
    plot(W/pi, 20*log10(abs(H)));
    hold on;
    plot([0 wp1], [-passband_ripple -passband_ripple], 'r--');
    plot([wp2 1], [-passband_ripple -passband_ripple], 'r--');
    plot([ws1 ws1], [-100 -stopband_attenuation], 'r--');
    plot([ws2 ws2], [-100 -stopband_attenuation], 'r--');
    hold off;
    title('å¹…é¢‘å“åº”');
    xlabel('é¢‘ç‡ (Ã—Ï€ rad/sample)');
    ylabel('å¹…åº¦ (dB)');
    subplot(2, 1, 2);
    plot(W/pi, angle(H));
    title('ç›¸é¢‘å“åº”');
    xlabel('é¢‘ç‡ (Ã—Ï€ rad/sample)');
    ylabel('ç›¸ä½ (radians)');
    ```
    
    ```matlab
    % å®šä¹‰æŠ€æœ¯æŒ‡æ ‡
    passband_frequency = 0.4;
    stopband_frequency = 0.6;
    passband_ripple = 0.5; % dB
    stopband_attenuation = 50; % dB
    
    % è®¡ç®—æ»¤æ³¢å™¨çš„é˜¶æ•°å’Œæˆªæ­¢é¢‘ç‡
    [N, Wn] = buttord(passband_frequency, stopband_frequency, passband_ripple, stopband_attenuation);
    
    % è®¾è®¡å·´ç‰¹æ²ƒæ–¯æ•°å­—ä½é€šæ»¤æ³¢å™¨
    [b, a] = butter(N, Wn);
    
    % è®¡ç®—å¹¶ç»˜åˆ¶æ»¤æ³¢å™¨çš„é¢‘ç‡å“åº”
    [H, W] = freqz(b, a, 1024);
    subplot(3, 1, 1);
    plot(W/pi, 20*log10(abs(H)));
    hold on;
    plot([0 passband_frequency], [-passband_ripple -passband_ripple], 'r--');
    plot([stopband_frequency 1], [-stopband_attenuation -stopband_attenuation], 'r--');
    hold off;
    title('å¹…é¢‘å“åº”');
    xlabel('é¢‘ç‡ (Ã—Ï€ rad/sample)');
    ylabel('å¹…åº¦ (dB)');
    subplot(3, 1, 2);
    plot(W/pi, angle(H));
    title('ç›¸é¢‘å“åº”');
    xlabel('é¢‘ç‡ (Ã—Ï€ rad/sample)');
    ylabel('ç›¸ä½ (radians)');
    
    % è®¡ç®—å¹¶ç»˜åˆ¶æ»¤æ³¢å™¨çš„å•ä½å†²æ¿€å“åº”
    [h, n] = impz(b, a);
    subplot(3, 1, 3);
    stem(n, h);
    title('å•ä½å†²æ¿€å“åº”');
    xlabel('n');
    ylabel('h[n]');
    ```