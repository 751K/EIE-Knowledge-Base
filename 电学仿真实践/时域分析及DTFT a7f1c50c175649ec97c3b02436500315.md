# 时域分析及DTFT

Owner: 柒柒在笔记
课程: Matlab

## **一、实验名称**

### Matlab在数字信号处理中的应用 ——时域分析及DTFT

## **二、实验内容**

1. **求信号卷积**
2. **求系统响应**
3. **已知低通数字滤波器系统函数**
    1. 输入序列的DTFT
    2. 滤波器的幅频响应
    3. 输出序列及其DTFT

## **三、实验步骤**

1. **求信号卷积**
    1. 定义一个长度N，并且让n从0到N-1，这样定义了n的范围。
    2. 创建一个长度为N的单位阵列Rn。
    3. 利用Rn和n以及指数衰减因子0.5创建第一组信号x1。在创建时让每个元素都乘以0.5的n次方。
    4. 同样地，利用Rn和n以及指数衰减因子0.5创建第二组信号x2。在创建时，首先让n减去5，然后让每个元素都乘以0.5的n次方，由于n减去了5，所以前面五个元素是0。
    5. 生成第三组信号x3，这是一个常量信号，和Rn相同，每个元素的值都是1。
    6. 计算x1和x3的卷积形成y1，计算x2和x3的卷积形成y2。卷积的操作就是在时域将一个信号经过另外一个信号的影响从而产生一个新的信号，这里通过conv函数进行卷积操作。
    7. 在制作可视化图标时，首先创建一个图象窗口。
        1. 在第一张子图中，使用stem函数绘制y1，其中x轴的范围为0到y1的长度-1，y轴的值为y1的值。
        2. 在第二张子图中，使用stem函数绘制y2，其中x轴的范围为0到y2的长度-1，y轴的值为y2的值。
2. **求系统响应**
    1. 定义一个序列长度为30。
    2. 创建一个新的图形窗口，并设置两个子图。
    3. 针对第一个信号x1：单位脉冲序列，其中只有第一项为1，其余项全为0。
    4. 使用filter函数，根据定义的滤波器（一个给定的差分方程[1,-0.8]）来计算这个单位脉冲信号的响应y1。
    5. 在子图上用stem函数来绘制y1，x轴是时间n（0至N-1），y轴是响应的值。
    6. 为这个子图添加标题 '\delta(n)'。
    7. 对于第二个信号x2：单位阶跃序列，其每一项都是1。
    8. 同样使用filter函数计算这个单位阶跃信号的响应y2。
    9. 在第二个子图上用stem函数来绘制y2，x轴是时间n（0至N-1），y轴是响应的值。
    10. 为这个子图添加标题 'u(n)'。
3. **已知低通数字滤波器系统函数**
    1. 定义A和B作为数字滤波器的分子和分母，A和B是由特定参数生成的多项式系数。
    2. 定义了采样频率为300Hz。
    3. 创建一个时间向量t，范围为0至0.2秒，步长为0.001秒，同时定义了信号x，在0至0.1秒的时间段内值为1，其余时间值为0。
    4. 定义一个新的时间间隔T1，作为1/采样频率，同时创建一个新的时间向量t1和相应的信号x1。
    5. 计算x1的离散时间傅立叶变换（DTFT）并存储在X1中，使用了一个在-3*pi至3*pi之间的等间隔向量作为频率值。
    6. 计算滤波器的频率响应H，在相同的频率范围内。
    7. 使用filter函数将滤波器应用于信号，得到滤波后的输出信号y。
    8. 计算滤波后信号y的DTFT，存储在变量Y中。
    9. 使用subplot函数创建六个子图。
        1. 在第一个子图中，绘制X1（未滤波信号的频谱）的幅度谱，并添加标题。
        2. 在第二个子图中，绘制滤波器的频率响应，并添加标题。
        3. 在第三个子图中，绘制滤波后信号y在时域的表现形式，并添加标题。
        4. 在第四个子图中，绘制滤波后的信号Y的频率谱，并添加标题。
    10. 最后，定义了dtft函数，用于计算给定信号的离散时间傅立叶变换。

## **四、实验结果**

1. **求信号卷积**
    
    ![Untitled](Untitled%2015.png)
    
2. **求系统响应**
    
    ![Untitled](Untitled%2016.png)
    
3. **已知低通数字滤波器系统函数**
    
    ![Untitled](Untitled%2017.png)
    

## **五、附录**

1. **求信号卷积**
    
    ```matlab
    N = 10; 
    n = 0:1:N-1; % 定义n的范围
    Rn = ones(1, N); 
    
    x1 = 0.5 .^ n .* Rn;
    x2 = 0.5 .^ (n-5) .* [zeros(1,5), Rn(1:N-5)];
    x3 = Rn;
    
    % 计算x1(n)*x3(n)和x2(n)*x3(n)
    y1 = conv(x1, x3);
    y2 = conv(x2, x3);
    
    % 可视化y1和y2
    figure;
    subplot(2, 1, 1);
    stem(0:length(y1)-1, y1);
    title('y1 = x1 * x3');
    xlabel('n');
    ylabel('y1');
    
    subplot(2, 1, 2);
    stem(0:length(y2)-1, y2);
    title('y2 = x2 * x3');
    xlabel('n');
    ylabel('y2');
    ```
    
2. **求系统响应**
    
    ```matlab
    % 定义序列长度
    N = 30;
    figure;
    subplot(2, 1, 1);
    % 对于𝑥_1 (𝑛)=𝛿(𝑛)
    x1 = [1, zeros(1, N-1)];  % 定义单位脉冲序列
    y1 = filter([1], [1, -0.8], x1);  % 使用filter函数求解差分方程
    stem(0:N-1, y1);  % 绘制y1
    title('\delta(n)');  % 添加标题
    
    % 对于𝑥_2 (𝑛)=𝑢(𝑛)
    subplot(2, 1, 2);
    x2 = ones(1, N);  % 定义单位阶跃序列
    y2 = filter([1], [1, -0.8], x2);  % 使用filter函数求解差分方程
    stem(0:N-1, y2);  % 绘制y2
    title('u(n)');  % 添加标题
    ```
    
3. **已知低通数字滤波器系统函数**
    
    ```matlab
    B=0.0003738*conv([1,1],conv([1,1],conv([1,1],conv([1,1],conv([1,1],[1,1])))));
    A=conv([1,-1.2686,0.7051],conv([1,-1.0106,0.3583],[1,-0.9044,0.2155]));
    fs=300;
    t=0:0.001:0.2;
    x=(t>=0)-(t>=0.1);
    T1=1/fs;
    t1=0:T1:0.2;
    n=0:0.2*fs;
    x1=(t1>=0)-(t1>=0.1);
    X1=dtft(x1,-3*pi:0.01:3*pi);
    
    w=-3*pi:0.01:3*pi;
    H=freqz(B,A,w);
    
    y=filter(B,A,x1);
    Y=dtft(y,-3*pi:0.01:3*pi);
    
    subplot(3,2,1:2)
    plot(-3*pi:0.01:3*pi,abs(X1));
    title('幅度谱');
    
    subplot(3,2,3:4)
    plot(w,abs(H));
    title('频率响应');
    
    subplot(3,2,5)
    stem(n,y)
    title('滤波器输出');
    
    subplot(3,2,6)
    plot(-3*pi:0.01:3*pi,abs(Y));
    title('DTFT输出频谱');
    
    function X=dtft(x,w)
    X=x*exp(-1i*(0:length(x)-1)'*w);
    end
    ```